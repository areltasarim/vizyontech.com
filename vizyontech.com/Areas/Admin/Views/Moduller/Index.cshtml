@model IEnumerable<Moduller>
@{
    ViewData["Title"] = ViewData["Baslik"].ToString();

    var _context = new AppDbContext();

    var controllerValue = HttpContextAccessor.HttpContext.Request.RouteValues["Controller"];

    var modulListesi = ViewData["ModulListesi"] as List<ModulListesi>;


    int c = 1;
}

<partial name="_SayfaBreadcrumb" />
<partial name="_BilgiMesaji" />

<div class="row">
    <div class="col-lg-12">
        <form method="post" id="pageForm" asp-area="Admin" asp-controller="@controllerValue" asp-action="DeleteAll">
            <div class="card">
                <div class="card-body">
                    @*<partial name="_SayfaHeaderButonlari" />*@
                    <table id="alternative-page-datatable" data-pattern="priority-columns" class="table dt-responsive nowrap w-100">
                        <thead>
                            <tr>
                                <partial name="_SayfaUstCheckbox" />
                                <th>Modül Adı</th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th style="width: 120px;">Kontrol</th>
                            </tr>
                        </thead>
                        <tbody id="tablolist">
                            @foreach (var item in modulListesi)
                            {

                                <tr>
                                    <td></td>
                                    <td>@item.Id</td>
                                    <td>
                                        @item.ModulAdi
                                    </td>
                                    <td>Resim</td>
                                    <td>Sıra</td>
                                    <td>Durum</td>
                                    <td>
                                        <a asp-controller="@item.Contoller" asp-action="@item.Action" asp-route-ModulId="@item.Id" asp-route-ModulTipi="@item.ModulTipi" class="mr-3 text-primary" data-toggle="tooltip" data-placement="top" title="Ekle" data-original-title="Ekle"><i class="mdi mdi-plus font-size-18"></i></a>
                                    </td>
                                </tr>
                                foreach (var modul in Model.Where(x => x.ModulTipi == item.ModulTipi))
                                {
                                   
                                    <tr>
                                        <td></td>
                                        <td>@modul.Id</td>
                                        <td>
                                            <i class="fa fa-folder-open" style="margin-left:25px;"></i>
                                            @modul.ModullerTranslate.SingleOrDefault(p => p.Diller.DilKodlari.DilKodu == "tr-TR").ModulAdi
                                        </td>
                                        <td>
                                            @foreach (var dil in _context.Diller.Where(x=> x.Durum == SayfaDurumlari.Aktif))
                                            {
                                                <a onclick='GaleriResimleri(@(modul.EntityId), @(dil.Id))' href='javascript: void()' class='btn btn-sm btn-success'>@dil.KisaDilAdi </a>

                                            }

                                        </td>
                                        <td>
                                            @modul.Sira
                                        </td>
                                        <td>
                                            <div class="badge badge-soft-@(modul.Durum == SayfaDurumlari.Aktif ? "success" : "danger") font-size-12">@(modul.Durum == SayfaDurumlari.Aktif ? "Aktif" : "Pasif")</div>
                                        </td>
                                        <td>
                                            <a asp-controller="@item.Contoller" asp-action="AddOrUpdate" asp-route-id="@modul.EntityId" asp-route-ModulId="@modul.Id" class="mr-3 text-primary" data-toggle="tooltip" data-placement="top" title="Düzenle" data-original-title="Düzenle"><i class="mdi mdi-pencil font-size-18"></i></a>
                                            <a asp-controller="@item.Contoller" asp-action="Delete" asp-route-id="@modul.EntityId" data-name="@ViewData["pageName"]" class="text-danger remove" data-toggle="tooltip" data-placement="top" title="Sil" data-original-title="Sil"><i class="mdi mdi-trash-can font-size-18"></i></a>
                                        </td>
                                    </tr>
                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </form>
    </div>
</div>
<partial name="_RemoveModal" />

@section scripts
{
    <partial name="_DataTableScriptsPartial" />

    <partial name="_CustomScriptsPartial" />


<script>
    $(document).ready(function () {
        $('.fancybox').fancybox();

        $.fn.fancybox.close = function () {
            //$('#sub_cont').hide(250, function() {
            //    $('#IDsearchform input').val('');
            //});
        };
        $(".fancybox-effects-a").fancybox({
            helpers: {
                title: {
                    type: 'outside'
                },
                overlay: {
                    speedOut: 0
                }
            }
        });
    });


    $(document).ready(function () {
        $('.fancybox').fancybox();

        $.fn.fancybox.close = function () {
            //$('#sub_cont').hide(250, function() {
            //    $('#IDsearchform input').val('');
            //});
            alert("?");
        };
        $(".fancybox-effects-a").fancybox({
            helpers: {
                title: {
                    type: 'outside'
                },
                overlay: {
                    speedOut: 0
                }
            }
        });
    });


    function GaleriResimleri(id, dil) {
        $.fancybox.open({
            href: '/Admin/OneCikanUrunler/PageImages/' + id + '?DilId=' + dil + '',
            type: 'iframe',
            width: 1000,
            minHeight: 600,
            padding: 5,
            //closeClick: false,
            onClosed: function () {
                //  Raporla();
                jQuery.fancybox.close();
            },
            afterClose: function () {
                //  Raporla();
                jQuery.fancybox.close();
            },
            mouseWheel: false

        });
    }

</script> 

}